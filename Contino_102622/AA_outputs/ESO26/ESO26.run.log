Fri Sep 16 10:11:08 PDT 2022
genome-workhorse0.priv
Global ref name is GRCh38
[root:INFO]	Commandline: /home/jluebeck/dev/AmpliconArchitect/src/AmpliconArchitect.py --ref GRCh38 --downsample 10 --bed /nucleus/projects/cancer_cell_lines/WGS/Contino_EAC_cell_lines/AA_outputs/ESO26/ESO26_AA_CNV_SEEDS.bed --bam /nucleus/projects/cancer_cell_lines/WGS/Contino_EAC_cell_lines/align_and_cnv/ERR1414290/ERR1414290.cs.rmdup.bam --runmode FULL --extendmode EXPLORE --insert_sdevs 3.0 --out /nucleus/projects/cancer_cell_lines/WGS/Contino_EAC_cell_lines/AA_outputs/ESO26/ESO26_AA_results//ESO26 
[root:INFO]	AmpliconArchitect version 1.3.r1

[root:INFO]	Python version 2.7.12 (default, Mar  1 2021, 11:38:31) 
[GCC 5.4.0 20160609]

[root:INFO]	#TIME 0.281	Loading libraries and reference annotations for: GRCh38
Global ref name is GRCh38
[root:INFO]	#TIME 3.881	Initiating bam_to_breakpoint object for: /nucleus/projects/cancer_cell_lines/WGS/Contino_EAC_cell_lines/align_and_cnv/ERR1414290/ERR1414290.cs.rmdup.bam
[root:INFO]	#TIME 3.883	Reusing cstats from /nucleus/libs/AmpliconArchitect/release/indexed/coverage.stats
[root:INFO]	#TIME 3.885	Exploring interval: chr5	51400000	54459756
[root:INFO]	#TIME 71.125	 Calculating coverage meanshift segmentation
[root:INFO]	#TIME 182.235	 Detecting breakpoint edges (interval neighbors)
[root:INFO]	#TIME 289.757	 Selecting neighbors
[root:INFO]	#TIME 819.908	Exploring interval: chr10	60980382	62960386
[root:INFO]	#TIME 900.500	 Calculating coverage meanshift segmentation
[root:INFO]	#TIME 985.803	 Detecting breakpoint edges (interval neighbors)
[root:INFO]	#TIME 1034.515	 Selecting neighbors
[root:INFO]	#TIME 1034.517	Exploring interval: chr10	77295401	79310404
[root:INFO]	#TIME 1060.348	 Calculating coverage meanshift segmentation
[root:INFO]	#TIME 1169.470	 Detecting breakpoint edges (interval neighbors)
[root:INFO]	#TIME 1229.960	 Selecting neighbors
[root:INFO]	#TIME 1229.963	 New neighbor: chr10	83275408	83880410	10 (weight=10)
[root:INFO]	#TIME 1229.963	 New neighbor: chr10	84285409	84970411	20 (weight=20)
[root:INFO]	#TIME 1229.966	Exploring interval: chr10	83275408	83880410
[root:INFO]	#TIME 1237.702	 Calculating coverage meanshift segmentation
[root:INFO]	#TIME 1247.972	 Detecting breakpoint edges (interval neighbors)
[root:INFO]	#TIME 1281.717	 Selecting neighbors
[root:INFO]	#TIME 1281.719	 New neighbor: chr10	77195401	79310404	9 (weight=9)
[root:INFO]	#TIME 1281.719	 New neighbor: chr10	84285409	84970411	14 (weight=14)
[root:INFO]	#TIME 1281.722	Exploring interval: chr10	84285409	84970411
[root:INFO]	#TIME 1284.466	 Calculating coverage meanshift segmentation
[root:INFO]	#TIME 1355.003	 Detecting breakpoint edges (interval neighbors)
[root:INFO]	#TIME 1390.763	 Selecting neighbors
[root:INFO]	#TIME 1926.145	 New neighbor: chr10	77195401	79310404	30 (weight=30)
[root:INFO]	#TIME 1926.145	 New neighbor: chr10	83275408	83880410	14 (weight=14)
[root:INFO]	#TIME 1926.146	 New neighbor: chr18	53065064	53075596	12 (weight=12)
[root:INFO]	#TIME 1928.854	 Calculating coverage meanshift segmentation
[root:INFO]	#TIME 1972.318	 Detecting breakpoint edges (interval neighbors)
[root:INFO]	#TIME 1974.188	 Selecting neighbors
[root:INFO]	#TIME 1974.190	Exploring interval: chr12	40480253	47985259
[root:INFO]	#TIME 2328.676	 Calculating coverage meanshift segmentation
[root:INFO]	#TIME 2737.874	 Detecting breakpoint edges (interval neighbors)
[root:INFO]	#TIME 3115.164	 Selecting neighbors
[root:INFO]	#TIME 3116.667	 New neighbor: chr16	27040387	27245362	61 (weight=61)
[root:INFO]	#TIME 3116.670	Exploring interval: chr16	27040387	27245362
[root:INFO]	#TIME 3176.879	 Calculating coverage meanshift segmentation
[root:INFO]	#TIME 3310.390	 Detecting breakpoint edges (interval neighbors)
[root:INFO]	#TIME 3341.190	 Selecting neighbors
[root:INFO]	#TIME 3341.192	 New neighbor: chr12	40380253	48085259	61 (weight=61)
[root:INFO]	#TIME 3341.194	Exploring interval: chr17	38421307	38976324
[root:INFO]	#TIME 3445.439	 Calculating coverage meanshift segmentation
[root:INFO]	#TIME 3785.271	 Detecting breakpoint edges (interval neighbors)
[root:INFO]	#TIME 4078.619	 Selecting neighbors
[root:INFO]	#TIME 4079.576	 New neighbor: chr17	39631341	39846348	197 (weight=197)
[root:INFO]	#TIME 4079.577	 New neighbor: chr17	40156356	40236360	285 (weight=285)
[root:INFO]	#TIME 4079.577	 New neighbor: chr17	41706319	41876852	433 (weight=433)
[root:INFO]	#TIME 4079.783	 Calculating coverage meanshift segmentation
[root:INFO]	#TIME 4120.270	 Detecting breakpoint edges (interval neighbors)
[root:INFO]	#TIME 4234.113	 Selecting neighbors
[root:INFO]	#TIME 4234.116	Exploring interval: chr17	39631341	39846348
[root:INFO]	#TIME 4269.336	 Calculating coverage meanshift segmentation
[root:INFO]	#TIME 4305.591	 Detecting breakpoint edges (interval neighbors)
[root:INFO]	#TIME 4478.364	 Selecting neighbors
[root:INFO]	#TIME 4478.366	 New neighbor: chr17	38321307	39076324	197 (weight=197)
[root:INFO]	#TIME 4478.366	 New neighbor: chr17	40156356	40236360	285 (weight=285)
[root:INFO]	#TIME 4478.369	Exploring interval: chr17	40156356	40236360
[root:INFO]	#TIME 4485.736	 Calculating coverage meanshift segmentation
[root:INFO]	#TIME 4491.889	 Detecting breakpoint edges (interval neighbors)
[root:INFO]	#TIME 4597.901	 Selecting neighbors
[root:INFO]	#TIME 4597.903	 New neighbor: chr17	39531341	39946348	285 (weight=285)
[root:INFO]	#TIME 4597.907	Interval sets for amplicons determined: 
[root:INFO]	[amplicon1]	chr5:51400000-54459756
[root:INFO]	[amplicon2]	chr10:60960382-62980386
[root:INFO]	[amplicon3]	chr10:77195401-79310404,chr10:83265408-83880410,chr10:84185409-85070411,chr18:53065064-53075596
[root:INFO]	[amplicon4]	chr12:40380253-48085259,chr16:26940387-27345362
[root:INFO]	[amplicon5]	chr17:38321307-39076324,chr17:39531341-39946348,chr17:40116356-40356360,chr17:41706319-41876852
[root:INFO]	#TIME 4597.914	Reconstructing amplicon1
[root:INFO]	#TIME 4597.915	 Calculating coverage meanshift segmentation
[root:INFO]	#TIME 4597.931	 Detecting breakpoint edges (interval filter vertices)
[root:INFO]	#TIME 4597.934	 Building breakpoint graph
[root:INFO]	#TIME 4598.383	 Optimizing graph copy number flow
[root:INFO]	#TIME 4686.398	 Plotting SV View
[root:INFO]	#TIME 4686.548	Plotting SV View for amplicon1
/usr/local/lib/python2.7/dist-packages/matplotlib/font_manager.py:1331: UserWarning: findfont: Font family [u'sans-serif'] not found. Falling back to DejaVu Sans
  (prop.get_family(), self.defaultFamily[fontext]))
[root:INFO]	#TIME 4689.193	Reconstructing amplicon2
[root:INFO]	#TIME 4689.195	 Calculating coverage meanshift segmentation
[root:INFO]	#TIME 4689.211	 Detecting breakpoint edges (interval filter vertices)
[root:INFO]	#TIME 4689.213	 Building breakpoint graph
[root:INFO]	#TIME 4689.339	 Optimizing graph copy number flow
[root:INFO]	#TIME 4751.815	 Plotting SV View
[root:INFO]	#TIME 4751.825	Plotting SV View for amplicon2
[root:INFO]	#TIME 4754.074	Reconstructing amplicon3
[root:INFO]	#TIME 4754.076	 Calculating coverage meanshift segmentation
[root:INFO]	#TIME 4754.139	 Detecting breakpoint edges (interval filter vertices)
[root:INFO]	#TIME 4870.007	 Building breakpoint graph
[root:INFO]	#TIME 4871.541	 Optimizing graph copy number flow
[root:INFO]	#TIME 4985.380	 Plotting SV View
[root:INFO]	#TIME 4986.346	Plotting SV View for amplicon3
[root:INFO]	#TIME 5233.734	Reconstructing amplicon4
[root:INFO]	#TIME 5233.735	 Calculating coverage meanshift segmentation
[root:INFO]	#TIME 5233.738	 Detecting breakpoint edges (interval filter vertices)
[root:INFO]	#TIME 5715.846	 Building breakpoint graph
[root:INFO]	#TIME 5800.599	 Optimizing graph copy number flow
[root:INFO]	#TIME 6186.314	 Plotting SV View
[root:INFO]	#TIME 6217.349	Plotting SV View for amplicon4
[root:INFO]	#TIME 6323.605	Reconstructing amplicon5
[root:INFO]	#TIME 6333.994	 Calculating coverage meanshift segmentation
[root:INFO]	#TIME 6445.536	 Detecting breakpoint edges (interval filter vertices)
[root:INFO]	#TIME 7182.292	 Building breakpoint graph
[root:INFO]	#TIME 7198.655	 Optimizing graph copy number flow
[root:INFO]	#TIME 7355.949	 Plotting SV View
[root:INFO]	#TIME 7357.577	Plotting SV View for amplicon5
[root:INFO]	#TIME 7995.404	Total Runtime
AmpliconClassifier 0.4.11
/home/jluebeck/ecDNA/AmpliconClassifier/amplicon_classifier.py -i /nucleus/projects/cancer_cell_lines/WGS/Contino_EAC_cell_lines/AA_outputs/ESO26/ESO26_classification/ESO26.input --ref GRCh38 -o /nucleus/projects/cancer_cell_lines/WGS/Contino_EAC_cell_lines/AA_outputs/ESO26/ESO26_classification/ESO26 --report_complexity
reading /nucleus/libs/AmpliconArchitect/release/indexed//GRCh38/Genes_hg38.gff
read 22998 genes

ESO26 amplicon1
ESO26 amplicon2
ESO26 amplicon3
ESO26 amplicon4
ESO26 amplicon5
Classification stage completed
Writing outputs...
done
2022-09-16 10:11:08.595053
PrepareAA version 0.1203.12

Matched /nucleus/projects/cancer_cell_lines/WGS/Contino_EAC_cell_lines/align_and_cnv/ERR1414290/ERR1414290.cs.rmdup.bam to reference genome GRCh38
Running PrepareAA on sample: ESO26
/nucleus/projects/cancer_cell_lines/WGS/Contino_EAC_cell_lines/align_and_cnv/ERR1414290/ERR1414290.cs.rmdup.bam: 1035439126 + 0 properly paired (93.39%:-nan%)
WARNING: BAM FILE PROPERLY PAIRED RATE IS BELOW 95%.
Quality of data may be insufficient for AA analysis. Poorly controlled insert size distribution during sample prep can cause high fractions of read pairs to be marked as discordant during alignment. Artifactual short SVs and long runtimes may occur!


Running amplified_intervals
python /home/jluebeck/dev/AmpliconArchitect/src/amplified_intervals.py --ref GRCh38 --bed /nucleus/projects/cancer_cell_lines/WGS/Contino_EAC_cell_lines/AA_outputs/ESO26//ERR1414290.cs.rmdup_CNV_CALLS_pre_filtered.bed --bam /nucleus/projects/cancer_cell_lines/WGS/Contino_EAC_cell_lines/align_and_cnv/ERR1414290/ERR1414290.cs.rmdup.bam --gain 4.5 --cnsize_min 50000 --out /nucleus/projects/cancer_cell_lines/WGS/Contino_EAC_cell_lines/AA_outputs/ESO26/ESO26_AA_CNV_SEEDS
python /home/jluebeck/dev/AmpliconArchitect/src/AmpliconArchitect.py --ref GRCh38 --downsample 10 --bed /nucleus/projects/cancer_cell_lines/WGS/Contino_EAC_cell_lines/AA_outputs/ESO26/ESO26_AA_CNV_SEEDS.bed --bam /nucleus/projects/cancer_cell_lines/WGS/Contino_EAC_cell_lines/align_and_cnv/ERR1414290/ERR1414290.cs.rmdup.bam --runmode FULL --extendmode EXPLORE --insert_sdevs 3.0 --out /nucleus/projects/cancer_cell_lines/WGS/Contino_EAC_cell_lines/AA_outputs/ESO26/ESO26_AA_results//ESO26

Running AC
/home/jluebeck/ecDNA/AmpliconClassifier/make_input.sh /nucleus/projects/cancer_cell_lines/WGS/Contino_EAC_cell_lines/AA_outputs/ESO26/ESO26_AA_results/ /nucleus/projects/cancer_cell_lines/WGS/Contino_EAC_cell_lines/AA_outputs/ESO26/ESO26_classification/ESO26
python3 /home/jluebeck/ecDNA/AmpliconClassifier/amplicon_classifier.py -i /nucleus/projects/cancer_cell_lines/WGS/Contino_EAC_cell_lines/AA_outputs/ESO26/ESO26_classification/ESO26.input --ref GRCh38 -o /nucleus/projects/cancer_cell_lines/WGS/Contino_EAC_cell_lines/AA_outputs/ESO26/ESO26_classification/ESO26 --report_complexity
python3 /home/jluebeck/ecDNA/AmpliconClassifier/make_results_table.py -i /nucleus/projects/cancer_cell_lines/WGS/Contino_EAC_cell_lines/AA_outputs/ESO26/ESO26_classification/ESO26.input --classification_file /nucleus/projects/cancer_cell_lines/WGS/Contino_EAC_cell_lines/AA_outputs/ESO26/ESO26_classification/ESO26_amplicon_classification_profiles.tsv --cnv_bed /nucleus/projects/cancer_cell_lines/WGS/Contino_EAC_cell_lines/AA_outputs/ESO26/ERR1414290.cs.rmdup_CNV_CALLS.bed --metadata_dict /nucleus/projects/cancer_cell_lines/WGS/Contino_EAC_cell_lines/AA_outputs/ESO26/ESO26_run_metadata.json
Completed

2022-09-16 13:30:51.876296
Fri Sep 16 13:30:52 PDT 2022
